---
layout: ../../layouts/MarkdownPostLayout.astro
title: GraphQL/OpenAPIの比較
pubDate: '2024-03-17T09:00:00.000Z'
tags: [GraphQL, OpenAPI]
draft: true
---

GraphQLとかOpenAPIとか使う機会これまで何度かあったがそれぞれのメリットデメリットをなんだっけ？となったので整理してみる。

### GraphQL/OpenAPIとは?
* GraphQL: APIのためのクエリ言語
  * クライアント側でクエリを構築してAPIサーバー似送信する
  * サーバーはクエリを解釈して必要なデータを取ってきたり処理を行ったりしてクライアントに結果を返す
  * 様々な言語で`クエリを解釈して実データ/処理とのつなぎこみを行う`ためのライブラリが提供されている
* OpenAPI: HTTP APIを記述するための仕様

### GraphQLとOpenAPIの比較要素
それぞれ解決しようとしている技術課題は完全一致しているわけではないが共通している部分もある。
* APIドキュメント生成によるクライアントとAPI間の疎結合
  → ドキュメントの整合性/正確性はどの程度か?
* APIドキュメントからクライアントコードの自動生成
  → どの程度有用か?

### ドキュメントの整合性/正確性
* GraphQLではコードからドキュメントが生成される
  * スキーマに従ってAPIを実装する必要があるためドキュメントと実際の挙動が異なるということはない。
    (schema firstでもcode firstでも)
* OpenAPIはコードからドキュメントを生成することもできるし、ドキュメントを自前で書いてコードを生成することもできる
  後者の場合はドキュメントと実動作が異なってしまう可能性がある。
  前者の場合はどう実装するか次第なところはある。
  きちんと型定義して各所できっちり使うことを徹底すれば整合性を担保できるはず。
  だが、言語とかフレームワーク？によってはレスポンスはstringとして定義することもできるのでその場合に生成されたドキュメントからはどんな型が返ってくるかは想像できない。
  要はきちんと型を使うようチーム内で認識が取れていればOpenAPIでも整合性/確実性は担保できる。

まとめ
* GraphQLでは実動作とドキュメントの動作が異なる、ということはない。
* OpenAPIは運用次第だが確実性を持たせるためには何らかの強制力を持った仕組みが必要

### 生成されたクライアントコードの有用性
TBW

### 参考
- [GraphQL vs OpenAPI スキーマ駆動開発比較](https://shikatech.hatenablog.com/entry/2022/03/16/132044)

